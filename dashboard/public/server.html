<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-locale-key="dashboard_server_page_title">Gerenciar Servidor</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="main-container">
    <aside class="sidebar">
      <div class="sidebar-header"><h1 id="bot-name" data-locale-key="dashboard_loading"></h1></div>
      <nav class="sidebar-nav" id="server-nav-links"></nav>
    </aside>

    <main class="dashboard-grid">
      <div class="widget">
        <h2 id="server-name-title">
            <i class="material-icons">dns</i>
            <span data-locale-key="dashboard_loading_server">Carregando...</span>
        </h2>
      </div>

      <!-- PAINEL DE IA -->
      <div id="panel-ai" class="settings-panel">
        <div id="panel-ai-container">
          <div class="widget">
            <h2><i class="material-icons">smart_toy</i> <span data-locale-key="dashboard_server_ai_settings"></span></h2>
            <div class="sub-widget">
              <h3><i class="material-icons">chat_bubble</i> <span data-locale-key="dashboard_server_ai_channels"></span></h3>
              <div id="channels-list" class="channels-list"></div>
            </div>
            <div class="sub-widget">
              <h3><i class="material-icons">tune</i> <span data-locale-key="dashboard_server_chatbot_settings"></span></h3>
              <form id="chatbot-settings-form" class="profile-form">
                <div class="form-group">
                  <label for="ai-context-limit" data-locale-key="dashboard_server_ai_context_limit_label">Context Limit</label>
                  <input type="number" id="ai-context-limit" class="form-number" min="1" max="50" value="15">
                  <small style="color:var(--muted); font-size:0.8rem;" data-locale-key="dashboard_server_ai_context_limit_desc"># of messages the bot remembers. (1-50)</small>
                </div>
                <div class="form-group">
                  <label data-locale-key="dashboard_server_ai_personality_label">Personality</label>
                  <div id="ai-personality-container"></div>
                  <button type="button" id="add-personality-btn" class="form-button-sm">+</button>
                </div>
                <div class="form-group">
                  <label data-locale-key="dashboard_server_ai_examples_label">Examples</label>
                  <div id="ai-examples-container"></div>
                  <button type="button" id="add-example-btn" class="form-button-sm">+</button>
                </div>
                <div class="sub-widget">
                  <h3><i class="material-icons">build_circle</i> <span data-locale-key="dashboard_server_ai_tool_permissions">AI Tool Permissions</span></h3>
                  <div id="ai-tools-list" class="tools-list" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;"></div>
                </div>
              </form>
            </div>
          </div>
          <div class="widget">
            <div class="chat-tester">
              <div class="chat-tester-header">
                <h2><i class="material-icons">psychology</i> <span data-locale-key="dashboard_server_ai_tester_title"></span></h2>
                <button id="clear-chat-btn"><i class="material-icons">delete_sweep</i> <span data-locale-key="dashboard_server_ai_tester_clear_button"></span></button>
              </div>
              <div id="chat-display" class="chat-tester-display"></div>
              <div class="chat-tester-input">
                <input type="text" id="chat-input" class="form-input" data-locale-placeholder-key="dashboard_server_ai_tester_input_placeholder">
                <button id="send-chat-btn" class="form-button"><i class="material-icons">send</i> <span data-locale-key="dashboard_server_ai_tester_send_button"></span></button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- PAINEL DE MUSICA -->
      <div id="panel-music" class="widget settings-panel" style="display: none;">
        <h2><i class="material-icons">music_note</i> <span data-locale-key="dashboard_server_music_title">Music</span></h2>
        <div id="music-container" style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px;">
            <div id="music-player-widget">
                <div class="sub-widget" id="now-playing-card">
                    <h3><i class="material-icons">play_circle</i> <span data-locale-key="dashboard_server_music_now_playing">Now Playing</span></h3>
                    <p id="np-song-title" data-locale-key="dashboard_server_music_nothing_playing">Nothing playing right now</p>
                    <div id="np-controls" style="display: flex; gap: 10px; margin-top: 10px;">
                        <button id="music-pause-btn" class="form-button"><i class="material-icons">pause</i></button>
                        <button id="music-resume-btn" class="form-button"><i class="material-icons">play_arrow</i></button>
                        <button id="music-skip-btn" class="form-button"><i class="material-icons">skip_next</i></button>
                    </div>
                </div>
                 <div class="sub-widget" id="music-settings-card" style="margin-top: 20px;">
                    <h3><i class="material-icons">settings</i> <span data-locale-key="dashboard_server_music_settings">Settings</span></h3>
                    <div class="form-group">
                        <label for="music-dj-role" data-locale-key="dashboard_server_music_dj_role">DJ Role</label>
                        <input type="text" id="music-dj-role" class="form-input" data-locale-placeholder-key="dashboard_server_music_dj_role_placeholder">
                    </div>
                </div>
            </div>
            <div class="sub-widget" id="music-queue-widget">
                <h3><i class="material-icons">queue_music</i> <span data-locale-key="dashboard_server_music_queue">Queue</span></h3>
                <div id="queue-list" style="max-height: 400px; overflow-y: auto;">
                    <p data-locale-key="dashboard_server_music_queue_empty">The queue is empty.</p>
                </div>
            </div>
        </div>
      </div>

      <!-- PAINEL DE FAQ -->
      <div id="panel-faq" class="widget settings-panel" style="display: none;">
        <h2><i class="material-icons">quiz</i> <span data-locale-key="dashboard_server_faq_settings"></span></h2>
        <div id="faq-list" class="faq-list"></div>
        <div class="profile-form">
          <input type="text" id="faq-new-question" class="form-input" data-locale-placeholder-key="dashboard_server_faq_new_question_placeholder">
          <textarea id="faq-new-answer" class="form-textarea" data-locale-placeholder-key="dashboard_server_faq_new_answer_placeholder"></textarea>
          <button id="faq-add-btn" class="form-button"><i class="material-icons">add</i> <span data-locale-key="dashboard_server_faq_add_button"></span></button>
        </div>
      </div>

      <!-- PAINEL DE KNOWLEDGE -->
      <div id="panel-knowledge" class="widget settings-panel" style="display: none;">
        <h2><i class="material-icons">school</i> <span data-locale-key="dashboard_server_knowledge_settings">Knowledge Base</span></h2>
        <div id="knowledge-list" class="faq-list"></div>
        <div class="profile-form">
          <input type="text" id="knowledge-new-question" class="form-input" data-locale-placeholder-key="dashboard_server_knowledge_new_question_placeholder">
          <textarea id="knowledge-new-answer" class="form-textarea" data-locale-placeholder-key="dashboard_server_knowledge_new_answer_placeholder"></textarea>
          <button id="knowledge-add-btn" class="form-button"><i class="material-icons">add</i> <span data-locale-key="dashboard_server_knowledge_add_button"></span></button>
        </div>
      </div>

      <!-- PAINEL DE GITHUB -->
      <div id="panel-github" class="settings-panel" style="display: none;">
        <div class="widget">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2><i class="material-icons">hub</i> <span data-locale-key="dashboard_server_github_title">GitHub Monitoring</span></h2>
                <button id="add-repo-btn" class="form-button"><i class="material-icons">add</i> <span data-locale-key="dashboard_server_github_add_repo_button">Add Repository</span></button>
            </div>
            <div id="repo-list"></div>
        </div>
      </div>

      <div class="widget">
        <button id="save-settings-btn" class="form-button">
            <i class="material-icons">save</i>
            <span data-locale-key="dashboard_server_save_button"></span>
        </button>
        <p id="save-status" class="status-message"></p>
      </div>
    </main>

    <!-- MODAL DO GITHUB -->
    <div id="repo-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 id="modal-title"><i class="material-icons">add_circle</i> <span data-locale-key="dashboard_server_github_modal_add_title">Add New Repository</span></h3>
            <form id="repo-form" class="profile-form">
                <input type="hidden" id="repo-id">
                <div class="form-group">
                    <label for="repo-url" data-locale-key="dashboard_server_github_modal_repo_url_label">GitHub Repository URL</label>
                    <input type="text" id="repo-url" class="form-input" placeholder="https://github.com/user/repo" required>
                </div>
                <div class="form-group">
                    <label for="repo-secret" data-locale-key="dashboard_server_github_modal_repo_secret_label">Webhook Secret</label>
                    <input type="text" id="repo-secret" class="form-input" data-locale-placeholder-key="dashboard_server_github_modal_repo_secret_placeholder">
                    <small style="color:var(--muted); font-size:0.8rem;" data-locale-key="dashboard_server_github_modal_repo_secret_desc">This must match the secret in your GitHub webhook settings.</small>
                </div>
                <div id="modal-config-sections"></div>
                <div class="modal-actions">
                    <button type="button" id="delete-repo-btn" class="form-button danger-btn" style="display: none;"><i class="material-icons">delete</i> <span data-locale-key="dashboard_server_github_modal_delete_button">Delete</span></button>
                    <button type="submit" class="form-button"><i class="material-icons">save</i> <span data-locale-key="dashboard_server_github_modal_save_button">Save</span></button>
                    <button type="button" id="cancel-modal-btn" class="form-button" style="background-color: var(--muted);"><i class="material-icons">cancel</i> <span data-locale-key="dashboard_server_github_modal_cancel_button">Cancel</span></button>
                </div>
            </form>
        </div>
    </div>
  </div>
  <script src="auth.js"></script>
  <script src="translator.js"></script>
  <script src="server.js"></script>
</body>
</html>